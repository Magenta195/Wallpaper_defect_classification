# ë°ì´ì½˜ ë„ë°° í•˜ì ìœ í˜• ë¶„ë¥˜ AI ê²½ì§„ëŒ€íšŒ

### <div align="center"><b><i></i></b></div>

&nbsp; 

> [ëŒ€íšŒë§í¬](https://dacon.io/competitions/official/236082/overview/description)
> 
> í”„ë¡œì íŠ¸ ê¸°ê°„ 2023.04 ~ 2023.05
> 
> ì•Œê³ ë¦¬ì¦˜ | ë¹„ì „ | ë¶„ë¥˜ | MLOps | Weight F1 Score

&nbsp; 

ğŸ” AI ê¸°ìˆ ì„ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¸í…Œë¦¬ì–´ í•˜ìë¥¼ íŒë‹¨í•˜ê³  ë¹ ë¥´ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìˆëŠ” ë¶„ë¥˜ ëª¨ë¸ ê°œë°œí•˜ê¸°

ğŸ’¾ ë³¸ ë ˆí¬ì§€í† ë¦¬ëŠ” ë„ë°°í•˜ì ê²½ì§„ëŒ€íšŒì—ì„œ ì‚¬ìš©í•œ ëª¨ë¸ì„ í•™ìŠµí•˜ëŠ” ì½”ë“œê°€ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

&nbsp;

# âš™ï¸ Tech Stack

<div align="center">
<img src="https://img.shields.io/badge/Python-3776AB0?style=for-the-badge&logo=Python&logoColor=white"><img src="https://img.shields.io/badge/Pytorch-009688?style=for-the-badge&logo=Pytorch&logoColor=white"><img src="https://img.shields.io/badge/Tensorflow-E92063?style=for-the-badge&logo=Tensorflow&logoColor=white"><img src="https://img.shields.io/badge/Keras-4169E1?style=for-the-badge&logo=Keras&logoColor=white"><img src="https://img.shields.io/badge/sklearn-FF9900?style=for-the-badge&logo=scikitlearn&logoColor=white"><img src="https://img.shields.io/badge/pyspark-2496ED?style=for-the-badge&logo=apachespark&logoColor=white">
</div>
&nbsp; 

# â“ About B2win Team

<div align="center">
  
| [@hwaxrang](https://github.com/hwaxrang) | [@Magenta195](https://github.com/Magenta195) | [@moongni](https://github.com/moongni) | [@heehaaaheeeee](https://github.com/heehaaaheeeee) | [@ShinEunChae](https://github.com/ShinEunChae) | [@joseokjun](https://github.com/joseokjun) |
|:---:|:---:|:---:|:---:|:---:|:---:|
| <img src="src/khr.png" width=200 /> | <img src="src/kth.jpeg" width=200 /> | <img src="src/mgh.png" width=200 /> | <img src="src/msh.jpg" width=200 /> | <img src="src/sec.jpeg" width=200 /> | <img src="src/jsj.jpg" width=200 /> |
| `ê¶Œí™”ë‘`   | `ê¹€íƒœí˜•` | `ë¬¸ê±´í¬` | `ë¬¸ìˆ™í¬` | `ì‹ ì€ì±„` | `ì¡°ì„ì¤€`  |

</div>

&nbsp; 

# ğŸ—ï¸ Key Service

ğŸ’¡ EDA ê²°ê³¼ ì´ 19ê°œì˜ í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ë¹„ëŒ€ì¹­ ë°ì´í„°(Unbalanced Data)ë¡œ í™•ì¸  

ğŸ’¡ ë¹„ëŒ€ì¹­ ë°ì´í„°ì˜ ë¶„ë¥˜ ëª¨ë¸ í•™ìŠµì„ ìœ„í•œ ë‹¤ì–‘í•œ ê¸°ë²• ì‚¬ìš©

| ì ìš©í•œ ê¸°ë²• | ê¸°ëŒ€ íš¨ê³¼ | 
|:---:|:---:|
|CutMix|ë‹¤ìˆ˜ í´ë˜ìŠ¤ì— ëŒ€í•œ ê³¼ì í•©ì„ ë°©ì§€í•˜ë©° ì†Œìˆ˜ í´ë˜ìŠ¤ì— ëŒ€í•´ì„œ ì ì ˆí•œ ê²°ì •ê²½ê³„ë¥¼ ê°€ì§€ëŠ” ëª¨ë¸ í•™ìŠµ|
|Focal Loss|easy classì— ëŒ€í•œ ì†ì‹¤ê°’ì„ ë‚®ì¶”ê³  hard classì— ëŒ€í•œ ì†ì‹¤ê°’ì„ ë†’ì—¬ ì†Œìˆ˜ í´ë˜ìŠ¤ì— ëŒ€í•œ ê°€ì¤‘ì¹˜ ë³€ê²½ ìœ ë„|
|Weighted Random Sampling|ë§¤ ë°°ì¹˜ ë§ˆë‹¤ 19ê°œ í´ë˜ìŠ¤ì— ëŒ€í•œ ë¹„êµì  ê· ë“±í•œ ìƒ˜í”Œë§ì„ ì§„í–‰|

ğŸ’¡ ë‹¤ì–‘í•œ capacityë¥¼ ê°€ì§„ CNN ë„¤íŠ¸ì›Œí¬ì˜ transfer learning ì„±ëŠ¥ì„ ë¹„êµí•˜ì—¬ ìµœì ì˜ ëª¨ë¸ì„ ì°¾ê³  í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ì„ í†µí•´ Best Model ì‘ì„±
| ëª¨ë¸ ê³„ì—´ ì¤‘ Best | Weighted F1 Score|
|:---:|:---:|
|ResNet-152|0.5648913541|
|DenseNet161|0.5681891560|
|InceptionNet-v3|0.5740491055|
|EfficientNet-v2m|0.61043914185|

**Best Model**
- EfficientNet-v2m ëª¨ë¸ 3ê°œ ë°°ê¹… ì•™ìƒë¸”
- Focal loss (label smooth)
- CutMix ì ìš©
- learning rate: 7e-4
- exponetial scheduler: gamma=0.8

&nbsp;

# ğŸ§­ Structure

```bash
ğŸ—‚ï¸ Backend
â”œâ”€â”€ ğŸ“‚ app
â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”œâ”€â”€ ğŸ“‚ api
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ endpoint.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ errors
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ http_errors.py
â”‚   â”‚   â””â”€â”€ ğŸ“‚ routes
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ admin.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ dl_server.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ requester.py
â”‚   â”‚       â””â”€â”€ ğŸ“„ wanted.py
â”‚   â”œâ”€â”€ ğŸ“‚ config
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ app.py
â”‚   â”‚   â””â”€â”€ ğŸ“„ model.py
â”‚   â”œâ”€â”€ ğŸ“‚ core
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â””â”€â”€ ğŸ“„ events.py
â”‚   â”œâ”€â”€ ğŸ“‚ db
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ events.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ queries
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ admin.py
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ wanted.py
â”‚   â”‚   â””â”€â”€ ğŸ“‚ repositories
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ admin.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ base.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ base_class.py
â”‚   â”‚       â””â”€â”€ ğŸ“„ wanted.py
â”‚   â”œâ”€â”€ ğŸ“‚ models
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ domain
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ admin.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ base.py
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ wanted.py
â”‚   â”‚   â””â”€â”€ ğŸ“‚ schemas
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ admin.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ base.py
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ errors.py
â”‚   â”‚       â””â”€â”€ ğŸ“„ wanted.py
â”‚   â”œâ”€â”€ ğŸ“‚ resources
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â””â”€â”€ ğŸ“„ strings.py
â”‚   â”œâ”€â”€ ğŸ“‚ secure
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ __init__.py
â”‚   â”‚   â””â”€â”€ ğŸ“„ hash.py
â”‚   â”œâ”€â”€ ğŸ“„ main.py
â”‚   â”œâ”€â”€ ğŸ“„ run.sh
â”‚   â””â”€â”€ ğŸ“„ run_https.sh
â”œâ”€â”€ ğŸ“„ readme.md
â””â”€â”€ ğŸ“„ requirements.txt
```
&nbsp;

# ğŸ“ Tutorial

ë³¸ ë°±ì—”ë“œ ë ˆí¬ì§€í† ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í™˜ê²½ì—ì„œ ë™ì‘ì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.

+ Python 3.10
+ Alpine linux ë„ì»¤ ì¸ìŠ¤í„´ìŠ¤
+ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤

PostgreSQL ë„ì»¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤í–‰ë˜ì—ˆë‹¤ëŠ” ì „ì œ í•˜ì— ì„¤ëª…ì„ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤.

(PostgreSQL ì ‘ì† í¬íŠ¸ ë° ì ‘ì† ì •ë³´ ì„¤ì •ì€ `app/config/model.py`ì—ì„œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.)

### requirements ì„¤ì¹˜

requirementë¥¼ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•´ ì£¼ì„¸ìš” (conda ë° venv ê°€ìƒí™˜ê²½ì„ ì¶”ì²œí•©ë‹ˆë‹¤.)

```bash
pip install -r requirements.txt
```

### httpë¡œ ì‹¤í–‰í•˜ê¸°

ëª…ë ¹ì–´ë¥¼ í†µí•´ `/app` ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•œ í›„, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.

```bash
sh run.sh
```

ì‹¤í–‰ í¬íŠ¸ ë° fastapi ê¸°ë³¸ ì„¤ì •, swagger docs ì‚¬ìš© ì„¤ì •ì€ `run.sh`íŒŒì¼ì„ ìˆ˜ì •í•˜ì—¬ ì„¸íŒ…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### httpsë¡œ ì‹¤í–‰í•˜ê¸°

ë³¸ ë°±ì—”ë“œ í”„ë¡œì íŠ¸ëŠ” **https í˜•ì‹** ì—­ì‹œ ì§€ì›í•©ë‹ˆë‹¤. `app/secure` ë””ë ‰í† ë¦¬ì— `key.pem`ê³¼ `cert.pem` íŒŒì¼ì„ ìƒì„±í•˜ê±°ë‚˜, openssl íŒ¨í‚¤ì§€ë¥¼ ë¨¼ì € ì„¤ì¹˜í•˜ê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.

ëª¨ë“  ì¤€ë¹„ ê³¼ì •ì´ ëë‚˜ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.

```bash
sh run_https.sh
```
